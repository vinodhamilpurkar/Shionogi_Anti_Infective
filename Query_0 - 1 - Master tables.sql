
-- Step 1 - Header

-- 
create table sandbox.ROM_Shionogi_GN_Claims_EMD_updated_v4 as
select
cast ((Cl.CLAIM_NUMBER) as varchar(100)) CLAIM_NUMBER,
CL.RECORD_TYPE,
PAYER_ID,
CODING_TYPE,
RECEIVED_DATE,
CLAIM_TYPE_CODE,
PAYER_NAME,
MEMBER_DOB,
MEMBER_ADR_STATE,
cl.MEMBER_ADR_ZIP,
PATIENT_RELATION,
PATIENT_GENDER,
PATIENT_DOB,
BILLING_PR_ID,
BILLING_PR_NPI,
BILLING_NAME1,
BILLING_NAME2,
BILLING_ADR_LINE1,
BILLING_ADR_LINE2,
BILLING_ADR_CITY,
BILLING_ADR_STATE,
BILLING_ADR_ZIP,
REFERRING_PR_ID,
REFERRING_PR_NPI,
REFERRING_NAME1,
REFERRING_NAME2,
ATTENDING_PR_ID,
ATTENDING_PR_NPI,
ATTENDING_NAME1,
ATTENDING_NAME2,
FACILITY_ID,
FACILITY_NAME1,
FACILITY_NAME2,
FACILITY_ADR_LINE1,
FACILITY_ADR_LINE2,
FACILITY_ADR_CITY,
FACILITY_ADR_STATE,
FACILITY_ADR_ZIP,
STATEMENT_FROM,
STATEMENT_TO,
TOTAL_CHARGE,
TOTAL_ALLOWED,
DRG_CODE,
TYPE_BILL,
PRINCIPAL_PROCEDURE,
ADMIT_DIAGNOSIS,
PRIMARY_DIAGNOSIS,
DIAGNOSIS_CODE_2,
DIAGNOSIS_CODE_3,
DIAGNOSIS_CODE_4,
DIAGNOSIS_CODE_5,
DIAGNOSIS_CODE_6,
DIAGNOSIS_CODE_7,
DIAGNOSIS_CODE_8,
OTHER_PROC_CODE_2,
OTHER_PROC_CODE_3,
OTHER_PROC_CODE_4,
OTHER_PROC_CODE_5,
OTHER_PROC_CODE_6,
PROV_SPECIALTY,
NEW_PATIENT,
INITIAL_PROCEDURE,
ADMISSION_DATE,
ADMISSION_HOUR,
ADMIT_TYPE_CODE,
ADMIT_SRC_CODE,
PATIENT_STATUS_CD,
OTHER_PROC_CODE_7,
OTHER_PROC_CODE_8,
OTHER_PROC_CODE_9,
OTHER_PROC_CODE_10,
BILLING_TAXONOMY,
BILLING_STATE_LIC,
BILLING_UPIN,
BILLING_SSN,
RENDERING_TAXONOMY,
RENDERING_STATE_LIC,
RENDERING_UPIN,
FACILITY_NPI,
FACILITY_STATE_LIC,
case when cl.member_adr_zip is not null and cl.member_adr_zip <> '' and cl.member_adr_zip <> ' ' then concat(trim (cl.patient_suffix),trim (cl.member_adr_zip)) else trim (cl.patient_suffix) end as Patient_id,
cl.patient_suffix,
sr.service_from
from condor_claim_record cl
Inner Join condor_Service_record sr on trim (cl.Claim_number) = trim (SR.Claim_number)
Where ((to_date (trim (service_from)) between '2014-10-01' and '2017-12-12') or (to_date (trim (STATEMENT_FROM)) between '2014-10-01' and '2017-12-12'))   AND
(trim (admit_diagnosis) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (primary_diagnosis) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_2) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_3) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_4) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_5) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_6) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_7) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or trim (diagnosis_code_8) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161'))

--
create table sandbox.ROM_Shionogi_GN_Claims_ALB_Updated_v4_1 as
SELECT
cast ((Cl.EntityID) as varchar(100)) CLAIM_NUMBER,
'C' as RECORD_TYPE,
cl.tspid as PAYER_ID,
'' as CODING_TYPE,
cl.createdate as RECEIVED_DATE,
'P' as CLAIM_TYPE_CODE,
cl.PrimaryPayerName as PAYER_NAME,
null as MEMBER_DOB,
cl.patientstate as MEMBER_ADR_STATE,
cl.patientzipcode as MEMBER_ADR_ZIP,
cl.PatientRelationshiptoInsured as PATIENT_RELATION,
cl.patientsex as PATIENT_GENDER,
cl.PatientDOB as PATIENT_DOB,
null as BILLING_PR_ID,
cl.BillingProvNPI as BILLING_PR_NPI,
null as BILLING_NAME1,
null as BILLING_NAME2,
null as BILLING_ADR_LINE1,
null as BILLING_ADR_LINE2,
null as BILLING_ADR_CITY,
null as BILLING_ADR_STATE,
null as BILLING_ADR_ZIP,
null as REFERRING_PR_ID,
cl.ReferringProvNPI as REFERRING_PR_NPI,
null as REFERRING_NAME1,
null as REFERRING_NAME2,
null as ATTENDING_PR_ID,
cl.RenderingProviderNPI as ATTENDING_PR_NPI,
null as ATTENDING_NAME1,
null as ATTENDING_NAME2,
null as FACILITY_ID,
cl.clientname as FACILITY_NAME1,
null as FACILITY_NAME2,
null as FACILITY_ADR_LINE1,
null as FACILITY_ADR_LINE2,
null as FACILITY_ADR_CITY,
null as FACILITY_ADR_STATE,
null as FACILITY_ADR_ZIP,
null as STATEMENT_FROM,
null as STATEMENT_TO,
cl.TotalClaimChargeAmount as TOTAL_CHARGE,
null as TOTAL_ALLOWED,
null as DRG_CODE,
null as TYPE_BILL,
null as PRINCIPAL_PROCEDURE,
null as ADMIT_DIAGNOSIS,
cl.DIAGNOSISCODE_1 as PRIMARY_DIAGNOSIS,
cl.DIAGNOSISCODE_2 as DIAGNOSIS_CODE_2,
cl.DIAGNOSISCODE_3 as DIAGNOSIS_CODE_3,
cl.DIAGNOSISCODE_4 as DIAGNOSIS_CODE_4,
cl.DIAGNOSISCODE_5 as DIAGNOSIS_CODE_5,
cl.DIAGNOSISCODE_6 as DIAGNOSIS_CODE_6,
cl.DIAGNOSISCODE_7 as DIAGNOSIS_CODE_7,
cl.DIAGNOSISCODE_8 as DIAGNOSIS_CODE_8,
null as OTHER_PROC_CODE_2,
null as OTHER_PROC_CODE_3,
null as OTHER_PROC_CODE_4,
null as OTHER_PROC_CODE_5,
null as OTHER_PROC_CODE_6,
cl.RenderingProviderSpecialtyCode as PROV_SPECIALTY,
null as New_Patient,
null as INITIAL_PROCEDURE,
cl.AdmissionDate as ADMISSION_DATE,
null as ADMISSION_HOUR,
null as ADMIT_TYPE_CODE,
null as ADMIT_SRC_CODE,
null as PATIENT_STATUS_CD,
null as OTHER_PROC_CODE_7,
null as OTHER_PROC_CODE_8,
null as OTHER_PROC_CODE_9,
null as OTHER_PROC_CODE_10,
cl.BillingorPayToProviderTaxonomyCode as BILLING_TAXONOMY,
null as BILLING_STATE_LIC,
null as BILLING_UPIN,
null as BILLING_SSN,
cl.ReferringProviderTaxonomyCode as RENDERING_TAXONOMY,
null as RENDERING_STATE_LIC,
null as RENDERING_UPIN,
null as FACILITY_NPI,
null as FACILITY_STATE_LIC,
case when cl.patientzipcode is not null and cl.patientzipcode <> '' and cl.patientzipcode <> ' ' then concat(trim (cl.patientsuffix),trim (cl.patientzipcode)) else trim (cl.patientsuffix) end as Patient_id,
cl.patientsuffix,
SR.servicefromdate
from albatross_claims_header cl
Inner Join albatross_claims_detail sr on trim (cl.entityid) = trim (SR.entityid)
Where (((servicefromdate)) between '2014-10-01' and '2017-12-12')   AND
(trim (DIAGNOSISCODE_1) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or  (DIAGNOSISCODE_2) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or (DIAGNOSISCODE_3) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or  (DIAGNOSISCODE_4) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or  (DIAGNOSISCODE_5) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or  (DIAGNOSISCODE_6) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or  (DIAGNOSISCODE_7) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161')
or  (DIAGNOSISCODE_8) in ('09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V09.0','V09.1','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161'))

-- Combined
Create Table sandbox.Shionogi_GN_Claims_Updated_v4 as 
Select distinct * from sandbox.ROM_Shionogi_GN_Claims_EMD_updated_v4
Union
Select distinct * from sandbox.ROM_Shionogi_GN_Claims_ALB_Updated_v4_1

-- Step 2 - Service

--
create table sandbox.ROM_Shionogi_GN_Services_EMD_Updated_v4 as
select
sv.CLAIM_NUMBER,
sv.RECORD_TYPE,
sv.LINE_NUMBER,
sv.SERVICE_FROM,
sv.SERVICE_TO,
sv.PLACE_SERVICE,
sv.PROCEDURE as PROCEDURE,
sv.PROCEDURE_QUAL,
sv.Procedure_Modifier_1,
sv.Procedure_Modifier_2,
sv.Procedure_Modifier_3,
sv.Procedure_Modifier_4,
sv.LINE_CHARGE,
sv.LINE_ALLOWED,
sv.UNITS,
sv.REVENUE_CODE,
sv.DIAGNOSIS_POINTER_1,
sv.DIAGNOSIS_POINTER_2,
sv.DIAGNOSIS_POINTER_3,
sv.DIAGNOSIS_POINTER_4,
sv.DIAGNOSIS_POINTER_5,
sv.DIAGNOSIS_POINTER_6,
sv.DIAGNOSIS_POINTER_7,
sv.DIAGNOSIS_POINTER_8,
sv.NDC,
sv.EMERGENCY
from condor_service_record sv
inner join sandbox.ROM_Shionogi_GN_Claims_EMD_updated_v4 cl 
on TRIM (cl.claim_number) = TRIM (sv.claim_number)

--
create table sandbox.ROM_Shionogi_GN_Services_ALB_Updated_v4 as
select
cast ((sv.EntityID) as varchar(100)) CLAIM_NUMBER,
'S' as RECORD_TYPE,
sv.ChargeLineNumber as LINE_NUMBER,
sv.servicefromdate as SERVICE_FROM,
sv.servicetodate as SERVICE_TO,
sv.placeofservice as PLACE_SERVICE,
sv.StdChgLineHCPCSProcedureCode as PROCEDURE,
null as PROCEDURE_QUAL,
sv.HCPCSModifier1 as Procedure_Modifier_1,
sv.HCPCSModifier2 as Procedure_Modifier_2,
sv.HCPCSModifier3 as Procedure_Modifier_3,
sv.HCPCSModifier4 as Procedure_Modifier_4,
sv.LineCharges as LINE_CHARGE,
null as LINE_ALLOWED,
sv.UnitsofService as UNITS,
null as REVENUE_CODE,
sv.DiagnosisCodePointer1 as DIAGNOSIS_POINTER_1,
sv.DiagnosisCodePointer2 as DIAGNOSIS_POINTER_2,
sv.DiagnosisCodePointer3 as DIAGNOSIS_POINTER_3,
sv.DiagnosisCodePointer4 as DIAGNOSIS_POINTER_4,
null as DIAGNOSIS_POINTER_5,
null as DIAGNOSIS_POINTER_6,
null as DIAGNOSIS_POINTER_7,
null as DIAGNOSIS_POINTER_8,
sv.ndccode as NDC,
null as EMERGENCY
from albatross_claims_detail sv
inner join sandbox.ROM_Shionogi_GN_Claims_ALB_Updated_v4_1 cl on trim (cl.claim_number) = trim (sv.EntityID)

-- Service records - Condor and Albatross
Create Table sandbox.Shionogi_GN_Services_Updated_v4 as 
Select distinct CLAIM_NUMBER, RECORD_TYPE, LINE_NUMBER, SERVICE_FROM, SERVICE_TO, PLACE_SERVICE, PROCEDURE, PROCEDURE_QUAL, Procedure_Modifier_1, Procedure_Modifier_2, Procedure_Modifier_3, Procedure_Modifier_4, LINE_CHARGE, UNITS, REVENUE_CODE, DIAGNOSIS_POINTER_1, DIAGNOSIS_POINTER_2, DIAGNOSIS_POINTER_3, DIAGNOSIS_POINTER_4, DIAGNOSIS_POINTER_5, DIAGNOSIS_POINTER_6, DIAGNOSIS_POINTER_7, DIAGNOSIS_POINTER_8, NDC, EMERGENCY
from sandbox.ROM_Shionogi_GN_Services_EMD_Updated_v4
Union All
Select distinct CLAIM_NUMBER, RECORD_TYPE, LINE_NUMBER, SERVICE_FROM, SERVICE_TO, PLACE_SERVICE, PROCEDURE, PROCEDURE_QUAL, Procedure_Modifier_1, Procedure_Modifier_2, Procedure_Modifier_3, Procedure_Modifier_4, LINE_CHARGE, UNITS, REVENUE_CODE, DIAGNOSIS_POINTER_1, DIAGNOSIS_POINTER_2, DIAGNOSIS_POINTER_3, DIAGNOSIS_POINTER_4, DIAGNOSIS_POINTER_5, DIAGNOSIS_POINTER_6, DIAGNOSIS_POINTER_7, DIAGNOSIS_POINTER_8, NDC, EMERGENCY
from sandbox.ROM_Shionogi_GN_Services_ALB_Updated_v4

-- Step 3 - Rx

create table sandbox.ROM_Shionogi_GN_Pharmacy_EMD_01_v4 as
select 
ph.emdeon_tdr_claimid_or_uow_agn as claim_number,
ph.record_id,
ph.date_authorized,
ph.version_number,
ph.transaction_code,
ph.transaction_count,
ph.service_provider_id,
ph.service_provider_id_qualifier,
ph.date_of_service,
ph.date_of_birth,
ph.patient_gender_code,
ph.patient_location,
ph.patient_state_or_province,
ph.patient_zip_or_postal_zone,
ph.patient_id_qualifier,
ph.provider_id,
ph.provider_id_qualifier,
ph.prescriber_id,
ph.primary_care_provider_id,
ph.prescriber_last_name,
ph.prescriber_id_qualifier,
ph.primary_care_provider_id_qualifier,
ph.patient_relationship_code,
ph.eligibility_clarification_code,
ph.coordination_of_benefits_count,
ph.other_payer_coverage_type,
ph.prescription_or_service_reference_number,
ph.fill_number,
ph.days_supply,
ph.compound_code,
ph.product_or_service_id,
ph.dispense_as_written_daw_or_product_select_code,
ph.date_prescription_written,
ph.number_of_refills_authorized,
ph.level_of_service,
ph.prescription_origin_code,
ph.submission_clarification_code,
ph.unit_dose_indicator,
ph.product_or_service_id_qualifier,
ph.quantity_dispensed,
ph.orig_prescribed_product_or_service_code,
ph.orig_prescribed_quantity,
ph.orig_prescribed_product_or_service_code_qualifier,
ph.prescription_or_service_reference_number_qualifier,
ph.prior_authorization_type_code,
ph.unit_of_measure,
ph.reason_for_service,
ph.professional_service_code,
ph.result_of_service_code,
ph.diagnosis_code,
ph.diagnosis_code_qualifier,
ph.response_code,
ph.patient_pay_amount,
ph.ingredient_cost_paid,
ph.dispensing_fee_paid,
ph.total_amount_paid,
ph.ncpdp_number,
ph.national_provider_id,
ph.plan_type,
ph.pharmacy_location_postal_code,
ph.reject_code_1,
ph.reject_code_2,
ph.reject_code_3,
ph.reject_code_4,
ph.reject_code_5,
ph.payer_id,
ph.payer_id_qualifier,
ph.plan_name,
ph.type_of_payment,
case when ph.patient_zip_or_postal_zone is not null and ph.patient_zip_or_postal_zone <> '' and ph.patient_zip_or_postal_zone <> ' ' then concat(trim (ph.patient_suffix),trim (ph.patient_zip_or_postal_zone)) else TRIM (ph.patient_suffix) end as patient_ID,
ph.patient_suffix
from condor_pharmacy_record ph
Inner join sandbox.Shionogi_GN_Claims_Updated_v4 fa on trim(ph.patient_suffix) = trim (fa.patient_suffix) and trim(ph.patient_zip_or_postal_zone) = trim (fa.member_adr_zip)
Where (to_date (trim (date_of_service)) between '2014-10-01' and '2017-12-12')

create table sandbox.ROM_Shionogi_GN_Pharmacy_EMD_02_v4 as
select 
ph.emdeon_tdr_claimid_or_uow_agn as claim_number,
ph.record_id,
ph.date_authorized,
ph.version_number,
ph.transaction_code,
ph.transaction_count,
ph.service_provider_id,
ph.service_provider_id_qualifier,
ph.date_of_service,
ph.date_of_birth,
ph.patient_gender_code,
ph.patient_location,
ph.patient_state_or_province,
ph.patient_zip_or_postal_zone,
ph.patient_id_qualifier,
ph.provider_id,
ph.provider_id_qualifier,
ph.prescriber_id,
ph.primary_care_provider_id,
ph.prescriber_last_name,
ph.prescriber_id_qualifier,
ph.primary_care_provider_id_qualifier,
ph.patient_relationship_code,
ph.eligibility_clarification_code,
ph.coordination_of_benefits_count,
ph.other_payer_coverage_type,
ph.prescription_or_service_reference_number,
ph.fill_number,
ph.days_supply,
ph.compound_code,
ph.product_or_service_id,
ph.dispense_as_written_daw_or_product_select_code,
ph.date_prescription_written,
ph.number_of_refills_authorized,
ph.level_of_service,
ph.prescription_origin_code,
ph.submission_clarification_code,
ph.unit_dose_indicator,
ph.product_or_service_id_qualifier,
ph.quantity_dispensed,
ph.orig_prescribed_product_or_service_code,
ph.orig_prescribed_quantity,
ph.orig_prescribed_product_or_service_code_qualifier,
ph.prescription_or_service_reference_number_qualifier,
ph.prior_authorization_type_code,
ph.unit_of_measure,
ph.reason_for_service,
ph.professional_service_code,
ph.result_of_service_code,
ph.diagnosis_code,
ph.diagnosis_code_qualifier,
ph.response_code,
ph.patient_pay_amount,
ph.ingredient_cost_paid,
ph.dispensing_fee_paid,
ph.total_amount_paid,
ph.ncpdp_number,
ph.national_provider_id,
ph.plan_type,
ph.pharmacy_location_postal_code,
ph.reject_code_1,
ph.reject_code_2,
ph.reject_code_3,
ph.reject_code_4,
ph.reject_code_5,
ph.payer_id,
ph.payer_id_qualifier,
ph.plan_name,
ph.type_of_payment,
case when ph.patient_zip_or_postal_zone is not null and ph.patient_zip_or_postal_zone <> '' and ph.patient_zip_or_postal_zone <> ' ' then concat(trim (ph.patient_suffix),trim (ph.patient_zip_or_postal_zone)) else TRIM (ph.patient_suffix) end as patient_ID,
ph.patient_suffix
from condor_pharmacy_record ph
Inner Join sandbox.shionogi_ai_ndc_codes ndc
on TRIM (ph.product_or_service_id) = TRIM (ndc.NDCNUM)
Where (to_date (trim (date_of_service)) between '2014-10-01' and '2017-12-12')

create table sandbox.Shionogi_GN_Pharmacy_EMD_Updated_v4 as 
Select distinct * from sandbox.ROM_Shionogi_GN_Pharmacy_EMD_01_v4
Union
Select distinct * from sandbox.ROM_Shionogi_GN_Pharmacy_EMD_02_v4

-- Step 4 - EHR

-- Problems
create table sandbox.KK_SHIONOGI_AI_PROBLEMS_v4 as
SELECT distinct a.genpatientID, ICD9, icd10, type, category, status, errorFlag, recordedDTTM, b.patientsuffix
FROM problems a
inner join MappingData b on trim (a.genpatientID) = trim (b.genpatientID)
where 
(
trim (ICD9) in ('M86.9','M86.8X9','M86.8X8','M86.8X7','M86.8X6','M86.8X5','M86.8X4','M86.8X3','M86.8X2','M86.8X1','M86.8X0','M86.8X','M86.8','M86.69','M86.68','M86.679','M86.672','M86.671','M86.67','M86.669','M86.662','M86.661','M86.66','M86.659','M86.652','M86.651','M86.65','M86.649','M86.642','M86.641','M86.64','M86.639','M86.632','M86.631','M86.63','M86.629','M86.622','M86.621','M86.62','M86.619','M86.612','M86.611','M86.61','M86.60','M86.6','M86.59','M86.58','M86.579','M86.572','M86.571','M86.57','M86.569','M86.562','M86.561','M86.56','M86.559','M86.552','M86.551','M86.55','M86.549','M86.542','M86.541','M86.54','M86.539','M86.532','M86.531','M86.53','M86.529','M86.522','M86.521','M86.52','M86.519','M86.512','M86.511','M86.51','M86.50','M86.5','M86.49','M86.48','M86.479','M86.472','M86.471','M86.47','M86.469','M86.462','M86.461','M86.46','M86.459','M86.452','M86.451','M86.45','M86.449','M86.442','M86.441','M86.44','M86.439','M86.432','M86.431','M86.43','M86.429','M86.422','M86.421','M86.42','M86.419','M86.412','M86.411','M86.41','M86.40','M86.4','M86.39','M86.38','M86.379','M86.372','M86.371','M86.37','M86.369','M86.362','M86.361','M86.36','M86.359','M86.352','M86.351','M86.35','M86.349','M86.342','M86.341','M86.34','M86.339','M86.332','M86.331','M86.33','M86.329','M86.322','M86.321','M86.32','M86.319','M86.312','M86.311','M86.31','M86.30','M86.3','M86.29','M86.28','M86.279','M86.272','M86.271','M86.27','M86.269','M86.262','M86.261','M86.26','M86.259','M86.252','M86.251','M86.25','M86.249','M86.242','M86.241','M86.24','M86.239','M86.232','M86.231','M86.23','M86.229','M86.222','M86.221','M86.22','M86.219','M86.212','M86.211','M86.21','M86.20','M86.2','M86.19','M86.18','M86.179','M86.172','M86.171','M86.17','M86.169','M86.162','M86.161','M86.16','M86.159','M86.152','M86.151','M86.15','M86.149','M86.142','M86.141','M86.14','M86.139','M86.132','M86.131','M86.13','M86.129','M86.122','M86.121','M86.12','M86.119','M86.112','M86.111','M86.11','M86.10','M86.1','M86.09','M86.08','M86.079','M86.072','M86.071','M86.07','M86.069','M86.062','M86.061','M86.06','M86.059','M86.052','M86.051','M86.05','M86.049','M86.042','M86.041','M86.04','M86.039','M86.032','M86.031','M86.03','M86.029','M86.022','M86.021','M86.02','M86.019','M86.012','M86.011','M86.01','M86.00','M86.0','A52.9','A52.8','A52.79','A52.78','A52.77','A52.76','A52.75','A52.74','A52.73','A52.72','A52.71','A52.7','A52.3','A52.2','A52.19','A52.17','A52.16','A52.15','A52.14','A52.13','A52.12','A52.11','A52.10','A52.1','A52.09','A52.06','A52.05','A52.04','A52.03','A52.02','A52.01','A52.00','A52.0','A48.1','A02.9','A02.8','A02.29','A02.25','A02.24','A02.23','A02.22','A02.21','A02.20','A02.2','A02.1','A02.0','G05.3','A79.9','A79.89','A79.81','A79.8','A79.1','A79.0','A24.9','A24.3','A24.2','A24.1','A24.0','A04.4','A04.3','A04.2','A04.1','A04.0','A27.9','A27.89','A27.81','A27.8','A27.0','J15.0','J14.','G00.0','A41.52','A41.51','A41.50','A41.5','A41.3','B96.81','B96.5','B96.4','B96.3','B96.29','B96.23','B96.22','B96.21','B96.20','B96.2','B96.1','T81.4XXA','T81.4XXA','K68.11','K68.11','B96.29','B96.23','B96.22','B96.21','B96.20','R78.81','N39.0','A54.86','A54.85','A54.84','A54.83','A54.82','A54.81','A54.6','A54.5','A54.49','A54.43','A54.42','A54.41','A54.40','A54.39','A54.33','A54.32','A54.31','A54.30','A54.29','A54.24','A54.23','A54.22','A54.21','A54.1','A54.09','A54.03','A54.02','A54.01','A54.00','A69.20','A20.0','A37.81','A37.80','A37.11','A37.10','A37.01','A37.00','G00.9','B96.89','A04.8','J15.6','A41.59','A41.50','A03.9','A03.8','A03.3','A03.2','A03.1','A03.0','A02.9','A02.8','A02.29','A02.25','A02.24','A02.23','A02.22','A02.21','A02.20','A02.1','A02.0','A01.4','A01.3','A01.2','A01.1','A01.09','A01.05','A01.04','A01.03','A01.02','A01.01','A01.00','A00.9','A00.1','A00.0','T81.4XXS','T81.4XXD','T81.4XXA','T81.4','Z16.19','Z16.12','Z16.11','Z16.10','Z16.1','A49.9', '730.29','730.28','730.27','730.26','730.25','730.24','730.23','730.22','730.21','730.2','730.19','730.18','730.17','730.16','730.15','730.14','730.13','730.12','730.11','730.1','730.09','730.08','730.06','730.05','730.04','730.03','730.02','730.01','730','098.84','093.24','093.23','093.22','093.21','093.20','093.2','036.42','482.84','009.0','008.44','038.44','003.9','003.8','003.29','003.24','003.23','003.22','003.21','003.20','003.2','003.1','003.0','003','341.2','323.1','083.2','482.1','038.43','025','024','008.42','008.3','100.9','100.89','100.81','100.8','100.0','100','482.0','041.3','482.2','320.0','041.5','038.41','041.49','041.43','041.42','041.41','041.4','041.86','041.7','041.6','998.59','041.49','041.43','041.42','041.41','041.4','790.7','599.0','098.39','098.30','098.3','098.2','098.19','098.10','098.1','098.0','088.81','020.0','003.0','033.1','033.0','004.9','004.8','004.3','004.2','004.1','004.0','004','002.9','002.3','002.2','002.1','002.0','002','001.1','001.0','482.83','320.82','041.85','038.49','038.40','038.4','008.47','V09.0','V09.1', '997.49','997.5','041.9','998.33','998.32','998.31','998.30','998.3','M869','M868X9','M868X8','M868X7','M868X6','M868X5','M868X4','M868X3','M868X2','M868X1','M868X0','M868X','M868','M8669','M8668','M86679','M86672','M86671','M8667','M86669','M86662','M86661','M8666','M86659','M86652','M86651','M8665','M86649','M86642','M86641','M8664','M86639','M86632','M86631','M8663','M86629','M86622','M86621','M8662','M86619','M86612','M86611','M8661','M8660','M866','M8659','M8658','M86579','M86572','M86571','M8657','M86569','M86562','M86561','M8656','M86559','M86552','M86551','M8655','M86549','M86542','M86541','M8654','M86539','M86532','M86531','M8653','M86529','M86522','M86521','M8652','M86519','M86512','M86511','M8651','M8650','M865','M8649','M8648','M86479','M86472','M86471','M8647','M86469','M86462','M86461','M8646','M86459','M86452','M86451','M8645','M86449','M86442','M86441','M8644','M86439','M86432','M86431','M8643','M86429','M86422','M86421','M8642','M86419','M86412','M86411','M8641','M8640','M864','M8639','M8638','M86379','M86372','M86371','M8637','M86369','M86362','M86361','M8636','M86359','M86352','M86351','M8635','M86349','M86342','M86341','M8634','M86339','M86332','M86331','M8633','M86329','M86322','M86321','M8632','M86319','M86312','M86311','M8631','M8630','M863','M8629','M8628','M86279','M86272','M86271','M8627','M86269','M86262','M86261','M8626','M86259','M86252','M86251','M8625','M86249','M86242','M86241','M8624','M86239','M86232','M86231','M8623','M86229','M86222','M86221','M8622','M86219','M86212','M86211','M8621','M8620','M862','M8619','M8618','M86179','M86172','M86171','M8617','M86169','M86162','M86161','M8616','M86159','M86152','M86151','M8615','M86149','M86142','M86141','M8614','M86139','M86132','M86131','M8613','M86129','M86122','M86121','M8612','M86119','M86112','M86111','M8611','M8610','M861','M8609','M8608','M86079','M86072','M86071','M8607','M86069','M86062','M86061','M8606','M86059','M86052','M86051','M8605','M86049','M86042','M86041','M8604','M86039','M86032','M86031','M8603','M86029','M86022','M86021','M8602','M86019','M86012','M86011','M8601','M8600','M860','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161','A499',  '73029','73028','73027','73026','73025','73024','73023','73022','73021','7302','73019','73018','73017','73016','73015','73014','73013','73012','73011','7301','73009','73008','73006','73005','73004','73003','73002','73001','730','09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V090','V091','99749','9975','0419', '99833','99832','99831','99830','9983')
or trim (icd10) in ('M86.9','M86.8X9','M86.8X8','M86.8X7','M86.8X6','M86.8X5','M86.8X4','M86.8X3','M86.8X2','M86.8X1','M86.8X0','M86.8X','M86.8','M86.69','M86.68','M86.679','M86.672','M86.671','M86.67','M86.669','M86.662','M86.661','M86.66','M86.659','M86.652','M86.651','M86.65','M86.649','M86.642','M86.641','M86.64','M86.639','M86.632','M86.631','M86.63','M86.629','M86.622','M86.621','M86.62','M86.619','M86.612','M86.611','M86.61','M86.60','M86.6','M86.59','M86.58','M86.579','M86.572','M86.571','M86.57','M86.569','M86.562','M86.561','M86.56','M86.559','M86.552','M86.551','M86.55','M86.549','M86.542','M86.541','M86.54','M86.539','M86.532','M86.531','M86.53','M86.529','M86.522','M86.521','M86.52','M86.519','M86.512','M86.511','M86.51','M86.50','M86.5','M86.49','M86.48','M86.479','M86.472','M86.471','M86.47','M86.469','M86.462','M86.461','M86.46','M86.459','M86.452','M86.451','M86.45','M86.449','M86.442','M86.441','M86.44','M86.439','M86.432','M86.431','M86.43','M86.429','M86.422','M86.421','M86.42','M86.419','M86.412','M86.411','M86.41','M86.40','M86.4','M86.39','M86.38','M86.379','M86.372','M86.371','M86.37','M86.369','M86.362','M86.361','M86.36','M86.359','M86.352','M86.351','M86.35','M86.349','M86.342','M86.341','M86.34','M86.339','M86.332','M86.331','M86.33','M86.329','M86.322','M86.321','M86.32','M86.319','M86.312','M86.311','M86.31','M86.30','M86.3','M86.29','M86.28','M86.279','M86.272','M86.271','M86.27','M86.269','M86.262','M86.261','M86.26','M86.259','M86.252','M86.251','M86.25','M86.249','M86.242','M86.241','M86.24','M86.239','M86.232','M86.231','M86.23','M86.229','M86.222','M86.221','M86.22','M86.219','M86.212','M86.211','M86.21','M86.20','M86.2','M86.19','M86.18','M86.179','M86.172','M86.171','M86.17','M86.169','M86.162','M86.161','M86.16','M86.159','M86.152','M86.151','M86.15','M86.149','M86.142','M86.141','M86.14','M86.139','M86.132','M86.131','M86.13','M86.129','M86.122','M86.121','M86.12','M86.119','M86.112','M86.111','M86.11','M86.10','M86.1','M86.09','M86.08','M86.079','M86.072','M86.071','M86.07','M86.069','M86.062','M86.061','M86.06','M86.059','M86.052','M86.051','M86.05','M86.049','M86.042','M86.041','M86.04','M86.039','M86.032','M86.031','M86.03','M86.029','M86.022','M86.021','M86.02','M86.019','M86.012','M86.011','M86.01','M86.00','M86.0','A52.9','A52.8','A52.79','A52.78','A52.77','A52.76','A52.75','A52.74','A52.73','A52.72','A52.71','A52.7','A52.3','A52.2','A52.19','A52.17','A52.16','A52.15','A52.14','A52.13','A52.12','A52.11','A52.10','A52.1','A52.09','A52.06','A52.05','A52.04','A52.03','A52.02','A52.01','A52.00','A52.0','A48.1','A02.9','A02.8','A02.29','A02.25','A02.24','A02.23','A02.22','A02.21','A02.20','A02.2','A02.1','A02.0','G05.3','A79.9','A79.89','A79.81','A79.8','A79.1','A79.0','A24.9','A24.3','A24.2','A24.1','A24.0','A04.4','A04.3','A04.2','A04.1','A04.0','A27.9','A27.89','A27.81','A27.8','A27.0','J15.0','J14.','G00.0','A41.52','A41.51','A41.50','A41.5','A41.3','B96.81','B96.5','B96.4','B96.3','B96.29','B96.23','B96.22','B96.21','B96.20','B96.2','B96.1','T81.4XXA','T81.4XXA','K68.11','K68.11','B96.29','B96.23','B96.22','B96.21','B96.20','R78.81','N39.0','A54.86','A54.85','A54.84','A54.83','A54.82','A54.81','A54.6','A54.5','A54.49','A54.43','A54.42','A54.41','A54.40','A54.39','A54.33','A54.32','A54.31','A54.30','A54.29','A54.24','A54.23','A54.22','A54.21','A54.1','A54.09','A54.03','A54.02','A54.01','A54.00','A69.20','A20.0','A37.81','A37.80','A37.11','A37.10','A37.01','A37.00','G00.9','B96.89','A04.8','J15.6','A41.59','A41.50','A03.9','A03.8','A03.3','A03.2','A03.1','A03.0','A02.9','A02.8','A02.29','A02.25','A02.24','A02.23','A02.22','A02.21','A02.20','A02.1','A02.0','A01.4','A01.3','A01.2','A01.1','A01.09','A01.05','A01.04','A01.03','A01.02','A01.01','A01.00','A00.9','A00.1','A00.0','T81.4XXS','T81.4XXD','T81.4XXA','T81.4','Z16.19','Z16.12','Z16.11','Z16.10','Z16.1','A49.9', '730.29','730.28','730.27','730.26','730.25','730.24','730.23','730.22','730.21','730.2','730.19','730.18','730.17','730.16','730.15','730.14','730.13','730.12','730.11','730.1','730.09','730.08','730.06','730.05','730.04','730.03','730.02','730.01','730','098.84','093.24','093.23','093.22','093.21','093.20','093.2','036.42','482.84','009.0','008.44','038.44','003.9','003.8','003.29','003.24','003.23','003.22','003.21','003.20','003.2','003.1','003.0','003','341.2','323.1','083.2','482.1','038.43','025','024','008.42','008.3','100.9','100.89','100.81','100.8','100.0','100','482.0','041.3','482.2','320.0','041.5','038.41','041.49','041.43','041.42','041.41','041.4','041.86','041.7','041.6','998.59','041.49','041.43','041.42','041.41','041.4','790.7','599.0','098.39','098.30','098.3','098.2','098.19','098.10','098.1','098.0','088.81','020.0','003.0','033.1','033.0','004.9','004.8','004.3','004.2','004.1','004.0','004','002.9','002.3','002.2','002.1','002.0','002','001.1','001.0','482.83','320.82','041.85','038.49','038.40','038.4','008.47','V09.0','V09.1', '997.49','997.5','041.9','998.33','998.32','998.31','998.30','998.3','M869','M868X9','M868X8','M868X7','M868X6','M868X5','M868X4','M868X3','M868X2','M868X1','M868X0','M868X','M868','M8669','M8668','M86679','M86672','M86671','M8667','M86669','M86662','M86661','M8666','M86659','M86652','M86651','M8665','M86649','M86642','M86641','M8664','M86639','M86632','M86631','M8663','M86629','M86622','M86621','M8662','M86619','M86612','M86611','M8661','M8660','M866','M8659','M8658','M86579','M86572','M86571','M8657','M86569','M86562','M86561','M8656','M86559','M86552','M86551','M8655','M86549','M86542','M86541','M8654','M86539','M86532','M86531','M8653','M86529','M86522','M86521','M8652','M86519','M86512','M86511','M8651','M8650','M865','M8649','M8648','M86479','M86472','M86471','M8647','M86469','M86462','M86461','M8646','M86459','M86452','M86451','M8645','M86449','M86442','M86441','M8644','M86439','M86432','M86431','M8643','M86429','M86422','M86421','M8642','M86419','M86412','M86411','M8641','M8640','M864','M8639','M8638','M86379','M86372','M86371','M8637','M86369','M86362','M86361','M8636','M86359','M86352','M86351','M8635','M86349','M86342','M86341','M8634','M86339','M86332','M86331','M8633','M86329','M86322','M86321','M8632','M86319','M86312','M86311','M8631','M8630','M863','M8629','M8628','M86279','M86272','M86271','M8627','M86269','M86262','M86261','M8626','M86259','M86252','M86251','M8625','M86249','M86242','M86241','M8624','M86239','M86232','M86231','M8623','M86229','M86222','M86221','M8622','M86219','M86212','M86211','M8621','M8620','M862','M8619','M8618','M86179','M86172','M86171','M8617','M86169','M86162','M86161','M8616','M86159','M86152','M86151','M8615','M86149','M86142','M86141','M8614','M86139','M86132','M86131','M8613','M86129','M86122','M86121','M8612','M86119','M86112','M86111','M8611','M8610','M861','M8609','M8608','M86079','M86072','M86071','M8607','M86069','M86062','M86061','M8606','M86059','M86052','M86051','M8605','M86049','M86042','M86041','M8604','M86039','M86032','M86031','M8603','M86029','M86022','M86021','M8602','M86019','M86012','M86011','M8601','M8600','M860','A529','A528','A5279','A5278','A5277','A5276','A5275','A5274','A5273','A5272','A5271','A527','A523','A522','A5219','A5217','A5216','A5215','A5214','A5213','A5212','A5211','A5210','A521','A5209','A5206','A5205','A5204','A5203','A5202','A5201','A5200','A520','A481','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A022','A021','A020','G053','A799','A7989','A7981','A798','A791','A790','A249','A243','A242','A241','A240','A044','A043','A042','A041','A040','A279','A2789','A2781','A278','A270','J150','J14','G000','A4152','A4151','A4150','A415','A413','B9681','B965','B964','B963','B9629','B9623','B9622','B9621','B9620','B962','B961','T814XXA','T814XXA','K6811','K6811','B9629','B9623','B9622','B9621','B9620','R7881','N390','A5486','A5485','A5484','A5483','A5482','A5481','A546','A545','A5449','A5443','A5442','A5441','A5440','A5439','A5433','A5432','A5431','A5430','A5429','A5424','A5423','A5422','A5421','A541','A5409','A5403','A5402','A5401','A5400','A6920','A200','A3781','A3780','A3711','A3710','A3701','A3700','G009','B9689','A048','J156','A4159','A4150','A039','A038','A033','A032','A031','A030','A029','A028','A0229','A0225','A0224','A0223','A0222','A0221','A0220','A021','A020','A014','A013','A012','A011','A0109','A0105','A0104','A0103','A0102','A0101','A0100','A009','A001','A000','T814XXS','T814XXD','T814XXA','T814','Z1619','Z1612','Z1611','Z1610','Z161','A499',  '73029','73028','73027','73026','73025','73024','73023','73022','73021','7302','73019','73018','73017','73016','73015','73014','73013','73012','73011','7301','73009','73008','73006','73005','73004','73003','73002','73001','730','09884','09324','09323','09322','09321','09320','0932','03642','48284','0090','00844','03844','0039','0038','00329','00324','00323','00322','00321','00320','0032','0031','0030','003','3412','3231','0832','4821','03843','025','024','00842','0083','1009','10089','10081','1008','1000','100','4820','0413','4822','3200','0415','03841','04149','04143','04142','04141','0414','04186','0417','0416','99859','04149','04143','04142','04141','0414','7907','5990','09839','09830','0983','0982','09819','09810','0981','0980','08881','0200','0030','0331','0330','0049','0048','0043','0042','0041','0040','004','0029','0023','0022','0021','0020','002','0011','0010','48283','32082','04185','03849','03840','0384','00847','V090','V091','99749','9975','0419', '99833','99832','99831','99830','9983')
)
and (lower (trim (status)) in ('',' ','active','acute','chronic','permanent'))
and (substr(recordedDTTM,1,7) >= '2014-10') and (substr(recordedDTTM,1,7) < '2017-12') 
AND UPPER (TRIM (errorFlag)) <>'Y'

create table sandbox.KK_SHIONOGI_AI_PROBLEMS_v4_2 AS
select * from sandbox.KK_SHIONOGI_AI_PROBLEMS_v4
where (trim (category) not in ('Family history of', 'Rule out')) or category is null

create table sandbox.KK_SHIONOGI_AI_PROBLEMS_v4_3 as
SELECT distinct a.*, b.zip3, case when b.zip3 is not null and b.zip3 <> '' and b.zip3 <> ' ' then concat(a.patientsuffix,b.zip3) else a.patientsuffix end as patient_ID
FROM sandbox.KK_SHIONOGI_AI_PROBLEMS_v4_2 a
left join patients b
on trim (a.genpatientid) = trim (b.genpatientid)

-- Drugs
CREATE TABLE sandbox.KK_SHIONOGI_AI_DRUGS_v4 as
SELECT DISTINCT a.genpatientID, name, status, A.ndc, recordedDTTM, C.patientsuffix, B.drugname
FROM medications a
inner join sandbox.rom_shionogi_ndc_2 b on trim (a.ndc) = trim (b.ndc) 
inner join MappingData c on trim (a.genpatientID) = trim (c.genpatientID)
where lower (trim (a.status)) in ('', ' ', 'active','administered','auto complete','complete','completed','continued','filled rx','hold for', 'in progress','discontinued','ordered','pending','resulted') AND (substr(recordedDTTM,1,7) >= '2014-10') and (substr(recordedDTTM,1,7) < '2017-09') and  trim (upper (errorFlag)) <> 'Y'

create table sandbox.KK_SHIONOGI_AI_DRUGS_v4_2 as
select distinct a.*, b.zip3, case when b.zip3 is not null and b.zip3 <> '' and b.zip3 <> ' ' then concat(a.patientsuffix,b.zip3) else a.patientsuffix end as patient_ID
from sandbox.KK_SHIONOGI_AI_DRUGS_v4 a
left join patients B on trim (a.genpatientid) = trim (b.genpatientid)

CREATE TABLE sandbox.KK_SHIONOGI_AI_EHR_PATIENTS_v4 as
SELECT DISTINCT genpatientID, patientsuffix, patient_ID FROM sandbox.KK_SHIONOGI_AI_DRUGS_v4_2
UNION
SELECT DISTINCT genpatientID, patientsuffix, patient_ID FROM sandbox.KK_SHIONOGI_AI_PROBLEMS_v4_3

create table sandbox.KK_SHIONOGI_AI_EHR_ORDERS_v4 as
select DISTINCT A.* 
         ,B.rectype
      ,B.rectypeVersion
      ,B.genclientID
      ,B.gen2ClientID
      ,B.gen2patientID
      ,B.encounterID
      ,B.orderID
      ,B.VersionID
      ,B.auditDataFlag
      ,B.name
      ,B.type
      ,B.status
      ,B.cpt4
      ,B.cptmod
      ,B.cptpos
      ,B.billingICD9Code
      ,B.billingICD10Code
      ,B.hcpcs
      ,B.source
      ,B.specimen
      ,B.orderDTTM
      ,B.recordedDTTM
      ,B.approvinggenproviderID
      ,B.ApprovingGen2ProviderID
      ,B.orderinggenproviderID
      ,B.OrderingGen2ProviderID
      ,B.performinggenproviderID
      ,B.PerformingGen2ProviderID
      ,B.genproviderID
      ,B.gen2ProviderID
      ,B.primarykey
      ,B.Inserted_Date
      ,B.Rw_NUM
      ,B.Updated_Date
FROM sandbox.KK_SHIONOGI_AI_EHR_PATIENTS_V4 A
INNER JOIN orders B
ON TRIM (A.genpatientID) = TRIM (B.genpatientID) 
WHERE
(substr(B.recordedDTTM,1,7) >= '2014-10') and (substr(B.recordedDTTM,1,7) < '2017-12')

create table sandbox.KK_SHIONOGI_AI_EHR_RESULTS_V4 as
select DISTINCT A.*
        ,rectype
      ,rectypeVersion
      ,genclientID
      ,gen2ClientID
      ,gen2patientID
      ,encounterID
      ,resultID
      ,versionID
      ,auditDataFlag
      ,orderID
      ,panel
      ,test
      ,value_x
      ,units
      ,refRange
      ,abnormalFlag
      ,resultStatus
      ,loinc
      ,ocdid
      ,errorFlag
      ,resultDTTM
      ,performedDTTM
      ,recordedDTTM
      ,genproviderID
      ,gen2ProviderID
      ,primarykey
      ,Inserted_Date
      ,Updated_Date
      ,Rw_Num
FROM sandbox.KK_SHIONOGI_AI_EHR_PATIENTS_v4 A
INNER JOIN RESULTS B
ON TRIM (A.genpatientID) = TRIM (B.genpatientID) 
WHERE (substr(B.recordedDTTM,1,7) >= '2014-10') and (substr(B.recordedDTTM,1,7) < '2017-12') AND (TRIM (b.loinc) IN ('49617-4','62237-3','63368-5','73834-4','73982-1','75683-3','75684-1','75685-8','75686-6','75687-4','77924-9','102-4','106-5','114-9','10-9','110-7','118-0','122-2','126-3','130-5','135-4','139-6','143-8','147-9','151-1','171-9','155-2','163-6','159-4','167-7','18-2','183-4','199-0','211-3','219-6','223-8','22-4','227-9','231-1','235-2','239-4','247-7','277-4','281-6','30-7','309-5','313-7','317-8','321-0','325-1','333-5','337-6','345-9','34-9','349-1','353-3','357-4','361-6','365-7','369-9','385-5','394-7','398-8','402-8','414-3','406-9','410-1','418-4','42-2','46-3','482-0','486-1','494-5','498-6','502-5','50-5','506-6','510-8','514-0','518-1','5-9','62-0','66-1','6650-6','6654-8','70-3','74-5','78-6','8273-5','82-8','86-9','90-1','94-3','98-4','18874-8','85-1','6986-4','84-4','83-6','18875-5','65-3','55628-2','64-6','63-8','18876-3','69-5','41669-3','68-7','67-9','55635-7','55636-5','55637-3','55634-0','18877-1','73-7','55639-9','72-9','71-1','18878-9','77-8','41670-1','76-0','75-2','76143-7','23636-4','35758-2','35757-4','23637-2','35762-4','35759-0','35760-8','35761-6','32377-4','35764-0','55640-7','35765-7','18880-5','81-0','35766-5','80-2','79-4','32375-8','54174-8','55641-5','54203-5','54908-9','18882-1','93-5','6988-0','92-7','91-9','18883-9','97-6','55642-3','96-8','95-0','18884-7','101-6','35767-3','100-8','99-2','54166-4','54168-0','35768-1','54167-2','18885-4','105-7','55643-1','104-0','103-2','18886-2','109-9','6989-8','50632-9','108-1','107-3','52128-6','55189-5','31139-9','31138-1','35771-5','35769-9','41671-9','35770-7','54191-2','54193-8','55644-9','54192-0','18887-0','113-1','6990-6','112-3','111-5','41729-5','41673-5','41674-3','41672-7','32374-1','35772-3','55645-6','35773-1','55738-9','55739-7','55740-5','55737-1','76147-8','18888-8','117-2','6991-4','25366-6','116-4','115-6','25220-5','41730-3','41676-8','41677-6','41675-0','53820-7','18889-6','8276-8','6992-2','8275-0','8274-3','18890-4','121-4','6993-0','120-6','119-8','41731-1','41680-0','41678-4','41679-2','18891-2','125-5','6994-8','124-8','123-0','76150-2','18892-0','129-7','55647-2','128-9','127-1','73605-8','73650-4','74170-2','73627-2','18893-8','134-7','6995-5','58705-5','133-9','132-1','35776-4','35774-9','42352-5','35775-6','55649-8','55650-6','55651-4','55648-0','76144-5','35779-8','35777-2','6996-3','35778-0','23709-9','35780-6','55652-2','35781-4','18894-6','138-8','6997-1','20378-6','137-0','136-2','43272-4','43269-0','85052-9','43271-6','43270-8','18895-3','142-0','6998-9','25367-4','141-2','140-4','50633-7','55190-3','31141-5','31140-7','41732-9','41682-6','41683-4','41681-8','51724-3','74699-0','55654-8','51774-8','35783-0','35782-2','55653-0','20460-2','18896-1','146-1','6999-7','145-3','144-6','18897-9','150-3','35784-8','149-5','148-7','18898-7','154-5','55629-0','153-7','152-9','18899-5','158-6','41684-2','157-8','156-0','18900-1','162-8','7000-3','161-0','160-2','55631-6','55632-4','55633-2','55630-8','18901-9','166-9','55638-1','165-1','164-4','18902-7','170-1','55646-4','169-3','168-5','18970-4','413-5','411-9','412-7','41719-6','41720-4','41721-2','41740-2','7044-1','72943-4','72944-2','73126-5','73127-3','73200-8','73201-6','73602-5','73624-9','73647-0','73603-3','73604-1','73625-6','73626-4','73648-8','73649-6','17473-0','18972-0','25269-2','35832-5','419-2','420-0','421-8','422-6','18912-6','204-8','205-5','206-3','207-1','29493-4','33333-6','42354-1','42355-8','42356-6','42357-4','55158-0','18928-2','18929-0','266-7','267-5','268-3','269-1','35817-6','50630-3','7016-9','7017-7','7018-5','18996-9','25227-0','25800-4','507-4','508-2','509-0','7055-7','11-7','12-5','13-3','14-1','18860-7','20373-7','23624-0','25174-4','25175-1','25176-9','25177-7','25178-5','25179-3','42642-9','48169-7','60564-2','60565-9','6975-7','18879-7','31142-3','31143-1','35763-2','42350-9','42351-7','42353-3','50631-1','58412-8','6643-1','6644-9','6645-7','6646-5','6987-2','8272-7','18868-0','41662-8','41663-6','41664-4','41727-9','43-0','44-8','45-5','6982-3','18969-6','407-7','408-5','409-3','54197-9','54198-7','54199-5','55704-1','7043-3','18861-5','17-4','6976-5','16-6','15-8','18862-3','21-6','6977-3','25310-4','20-8','19-0','55614-2','55616-7','55615-9','18864-9','29-9','6979-9','28-1','27-3','18865-6','33-1','6980-7','20374-5','32-3','31-5','18991-0','493-7','54190-4','492-9','491-1','18873-0','61-2','41668-5','60-4','59-6','18932-4','280-8','7019-3','23613-3','279-0','278-2','25221-3','54170-6','54172-2','35819-2','54171-4','18943-1','6653-0','7029-2','6652-2','6651-4','18945-6','324-4','7030-0','323-6','322-8','75755-9','344-2','41703-0','343-4','342-6','18961-3','384-8','7039-1','383-0','382-2','18964-7','13968-3','6932-8','18965-4','393-9','7041-7','392-1','391-3','51504-9','51503-1','58085-2','77960-3','55136-6','58080-3','55137-4','18966-2','397-0','7042-5','396-2','395-4','35874-7','35872-1','35873-9','41728-7','41666-9','41667-7','41665-1','60535-2','72893-1','58711-3','56031-8','35802-8','35799-6','35800-2','35801-0','73600-9','73645-4','73622-3','53823-1','73590-2','73635-5','73612-4','55289-3','55291-9','55290-1','18933-2','284-0','283-2','282-4','285-7','6649-9','6648-1','6647-3','23622-4','18857-3','4-2','3-4','2-6','6-7','16350-1','18859-9','9-1','7028-4','8-3','7-5','18951-4','348-3','41704-8','347-5','346-7','18867-2','41-4','41661-0','40-6','39-8','18931-6','276-6','275-8','274-1','18913-4','210-5','55666-2','209-7','208-9','18923-3','246-9','245-1','244-4','18947-2','332-7','41702-2','331-9','330-1','54194-6','54196-1','54195-3','18994-4','501-7','7053-2','500-9','499-4','18995-1','505-8','7054-0','504-1','503-3','55717-3','55718-1','55719-9','55716-5','18869-8','49-7','55620-9','48-9','47-1','18916-7','222-0','55668-8','221-2','220-4','18971-2','417-6','416-8','415-0','18988-6','481-2','480-4','479-6','18967-0','401-0','400-2','399-6','23618-2','23925-1','33298-1','32380-8','29576-6','50546-1','49589-5','50545-3','6984-9','6985-6','18950-6','11576-6','16421-0','16830-2','18866-4','18919-1','18920-9','20380-2','234-5','23612-5','232-9','233-7','236-0','237-8','238-6','25224-7','35-6','36-4','37-2','38-0','7009-4','6981-5','18978-7','35793-9','35794-7','35795-4','35843-2','35844-0','35845-7','41722-0','443-2','444-0','445-7','446-5','7007-8','7046-6','73587-8','73609-0','73632-2','76149-4','16620-7','188-3','18907-6','189-1','190-9','191-7','20375-2','25190-0','25191-8','25192-6','43987-7','43990-1','43991-9','7003-7','62258-9','23633-1','23619-0','14325-5','10670-8','10352-3','10353-1','10354-9','10635-1','10638-5','10639-3','10643-5','10687-2','10694-8','10713-6','10716-9','10728-4','10730-0','10851-4','11255-7','11261-5','11267-2','11268-0','11469-4','11475-1','11550-1','12276-2','12281-2','14475-8','14476-6','14477-4','14478-2','14479-0','14480-8','13315-7','13316-5','13317-3','13318-1','14093-9','14127-5','14226-5','14320-6','14461-8','14462-6','14463-4','14464-2','14465-9','14466-7','14467-5','14481-6','14482-4','14483-2','14484-0','14485-7','14486-5','14487-3','14788-4','14838-7','15388-2','17279-1','16134-9','16483-0','16676-9','16832-8','16835-1','16836-9','17563-8','17576-0','17879-8','17880-6','17881-4','17882-2','17883-0','17656-0','17852-5','17873-1','17874-9','17875-6','17876-4','17877-2','17878-0','17884-8','17885-5','17886-3','17887-1','17888-9','17889-7','17890-5','17891-3','17892-1','17893-9','17894-7','17895-4','17896-2','17897-0','17898-8','17899-6','17900-2','17901-0','17902-8','17903-6','17904-4','17905-1','17906-9','17907-7','17908-5','17909-3','17910-1','17911-9','17912-7','17913-5','17914-3','17915-0','17916-8','17917-6','17918-4','17919-2','17920-0','17921-8','17922-6','17923-4','17924-2','17925-9','17926-7','17927-5','17928-3','17929-1','17930-9','17931-7','17932-5','17933-3','17934-1','17935-8','17936-6','17937-4','17938-2','17939-0','17940-8','17941-6','17942-4','17943-2','17944-0','17945-7','17946-5','17950-7','17951-5','17952-3','17953-1','17954-9','17955-6','17956-4','17957-2','17958-0','17959-8','17960-6','17961-4','17962-2','17963-0','17964-8','17965-5','17966-3','17967-1','17968-9','17969-7','17970-5','17971-3','17972-1','17973-9','17974-7','18482-0','18483-8','19054-6','19126-2','19127-0','19128-8','19129-6','20430-5','20752-2','20474-3','20566-6','20688-8','20691-2','20692-0','20693-8','20694-6','20696-1','20734-0','20735-7','20738-1','20739-9','20740-7','20762-1','20773-8','20811-6','20823-1','20866-0','20869-4','20870-2','20871-0','20878-5','20879-3','20892-6','20893-4','20896-7','20898-3','20899-1','20902-3','20952-8','20953-6','20954-4','20955-1','20962-7','20963-5','20964-3','20966-8','20967-6','20968-4','20976-7','20987-4','21020-3','21184-7','21284-5','23594-5','23599-4','23600-0','23602-6','23603-4','23604-2','23605-9','23606-7','24003-6','24005-1','24409-5','24427-7','27907-5','28549-4','29885-1','30045-9','30099-6','30122-6','32355-0','32367-5','32368-3','33676-8','33677-6','33685-9','33686-7','33694-1','33695-8','34891-2','38393-5','38394-3','38353-9','38354-7','38376-0','38377-8','40684-3','42255-0','43389-6','43107-2','43214-6','43307-8','43365-6','43371-4','43383-9','43384-7','43385-4','43386-2','43387-0','43407-6','43408-4','43409-2','43410-0','43411-8','43426-6','43441-5','43442-3','44800-1','43879-6','43890-3','43896-0','43925-7','43979-4','44015-6','44089-1','44090-9','44093-3','44853-0','44854-8','44855-5','44856-3','44857-1','45095-7','45096-5','45097-3','45098-1','45099-9','45100-5','45101-3','45102-1','44797-9','44798-7','44799-5','44841-5','44842-3','44843-1','44844-9','44845-6','44846-4','44847-2','44848-0','44849-8','44850-6','44851-4','44852-2','44858-9','44859-7','45093-2','45094-0','45275-5','45276-3','45335-7','45337-3','46454-5','47293-6','47294-4','47295-1','48561-5','48562-3','48563-1','48564-9','48565-6','48566-4','48567-2','48568-0','48569-8','48724-9','48727-2','48741-3','48806-4','48872-6','48873-4','48874-2','48875-9','49110-0','50941-4','51710-2','535-5','52966-9','52967-7','52968-5','52969-3','52973-5','532-2','533-0', '536-3','541-3','542-1','534-8','53558-3','53571-6','53572-4','53614-4','53615-1','53616-9','53617-7','537-1','538-9','53908-0','53909-8','53911-4','53955-1','539-7','540-5','546-2','543-9','547-0','548-8','549-6','55101-0','551-2','552-0','553-8','554-6','555-3','556-1','563-7','557-9','558-7','559-5','560-3','562-9','567-8','56474-0','56714-9','56715-6','57019-2','58077-9','581-9','585-0','582-7','583-5','584-3','586-8','587-6','5878-4','589-2','58940-8','590-0','59051-3','59065-3','59150-3','59151-1','591-8','592-6','596-7','60257-3','60258-1','593-4','594-2','595-9','597-5','598-3','599-1','607-2','60032-0','600-7','602-3','603-1','604-9','605-6','606-4','608-0','609-8','610-6','611-4','616-3','617-1','622-1','618-9','619-7','620-5','621-3','623-9','624-7','625-4','626-2','627-0','628-8','629-6','630-4','631-2','6317-2','632-0','6323-0','6330-5','6331-3','6332-1','6335-4','633-8','634-6','63480-8','6348-7','6349-5','635-3','636-1','6463-4','64412-0','6453-5','6454-3','6455-0','6459-2','6460-0','6461-8','6462-6','6486-5','6546-6','6544-1','6545-8','6578-9','6579-7','6580-5','6581-3','6594-6','6595-3','6596-1','6600-1','6609-2','68458-9','683-3','68366-4','684-1','685-8','686-6','687-4','688-2','689-0','690-8','691-6','692-4','693-2','694-0','69410-9','695-7','696-5','697-3','698-1','701-3','70850-3','70851-1','71472-5','72607-5','73558-9','74732-9','74733-7','73835-1','73836-9','73960-7','73961-5','73962-3','73963-1','74348-4','74355-9','74356-7','74731-1','74736-0','74737-8','74738-6','74739-4','74740-2','74741-0','74742-8','74743-6','74744-4','74745-1','74746-9','74747-7','74748-5','74749-3','74816-0','75269-1','75357-4','75358-2','75359-0','75673-4','75674-2','75675-9','75676-7','75677-5','75678-3','75679-1','75680-9','75681-7','75682-5','75688-2','75690-8','76081-9','76687-3','76693-1','77666-6','77193-1','77344-0','77495-0','77496-8','78356-3','78702-8','78921-4','79425-5','80367-6','80368-4','80369-2','81316-2','82298-1','82300-5','82301-3','82302-1','82303-9','82304-7','82305-4','9781-6','9816-0','9822-8','9823-6','9824-4','10718-5','10723-5','10724-3','10864-7','10908-2','11257-3','11260-7','12185-5','12261-4','12262-2','13170-6','13171-4','13172-2','15458-3','14474-1','13630-9','13631-7','13922-0','13923-8','13947-7','13948-5','13957-6','13971-7','14008-7','14009-5','14010-3','14030-1','14077-2','14078-0','14275-2','14468-3','14469-1','14470-9','14471-7','14472-5','14473-3','14922-9','14978-1','15168-8','15169-6','15170-4','15483-1','15485-6','15487-2','15489-8','15492-2','15494-8','16475-6','16476-4','16478-0','16479-8','16480-6','16481-4','16482-2','16635-5','16652-0','16654-6','16655-3','16656-1','16657-9','16658-7','16659-5','16660-3','16661-1','16662-9','16663-7','16664-5','16665-2','16666-0','16833-6','16860-9','17314-6','19243-5','17340-1','17459-9','17534-9','17541-4','17570-3','17585-1','17588-5','17590-1','17617-2','17618-0','17619-8','17627-1','17629-7','17638-8','17639-6','17640-4','17642-0','17643-8','17644-6','17645-3','17646-1','17648-7','17649-5','17650-3','17651-1','17654-5','17669-3','17671-9','17715-4','17780-8','17859-0','18262-6','19107-2','19253-4','20415-6','20449-5','20495-8','20496-6','20567-4','20568-2','20730-8','20731-6','20732-4','20755-5','20756-3','20900-7','21118-5','21119-3','21262-1','21282-9','21283-7','21302-5','21303-3','21348-8','23349-4','23450-0','22795-9','22846-0','22848-6','22850-2','22863-5','22922-9','22923-7','22932-8','22952-6','22958-3','22969-0','22996-3','23011-0','23019-3','23021-9','23027-6','23053-2','23124-1','23133-2','23153-0','23179-5','23186-0','23195-1','23199-3','23201-7','23237-1','23240-5','23250-4','23257-9','23263-7','23284-3','23287-6','23294-2','23341-1','23423-7','23424-5','23428-6','23434-4','23449-2','23464-1','23468-2','23477-3','23512-7','23524-2','23528-3','23531-7','23535-8','23644-8','23645-5','23646-3','23647-1','23660-4','23710-7','23756-0','23882-4','23884-0','23879-0','23880-8','23881-6','23951-7','23952-5','23997-0','23998-8','23999-6','24000-2','24001-0','24033-3','24034-1','24035-8','24110-9','24127-3','24128-1','24129-9','24130-7','25882-2','25884-8','24383-2','24385-7','24386-5','24387-3','24388-1','24398-0','24428-5','25325-2','25389-8','25397-1','25407-8','25410-2','25423-5','25747-7','25757-6','26880-5','25987-9','26684-1','26703-9','26715-3','26775-7','26818-5','26870-6','26892-0','26926-6','26975-3','27072-8','27093-4','27227-8','27228-6','27229-4','27230-2','27231-0','27260-9','27342-5','27384-7','27391-2','27407-6','27417-5','27422-5','27425-8','27426-6','27427-4','27428-2','27429-0','27430-8','27431-6','27433-2','27434-0','27435-7','27437-3','27440-7','27817-6','27831-7','27894-5','27924-0','28035-4','28078-4','28551-0','28546-0','28547-8','29643-4','29644-2','29657-4','29658-2','29659-0','29664-0','29773-9','29777-0','29896-8','29901-6','29903-2','29905-7','30046-7','29950-3','29952-9','29954-5','29955-2','29958-6','29959-4','29960-2','29961-0','29962-8','29964-4','29965-1','29996-6','29997-4','30038-4','30084-8','30169-7','30343-8','31178-7','30561-5','30568-0','30569-8','31154-8','31155-5','3173-2','3180-7','3181-5','3182-3','32031-7','32032-5','32033-3','32001-0','32002-8','32003-6','32004-4','32218-0','32219-8','3254-0','32677-7','32723-9','3280-5','32849-2','32850-0','32853-4','3285-4','3286-2','3287-0','33416-9','33410-2','33510-9','33564-6','33567-9','33569-5','33573-7','33588-5','33589-3','33665-1','33690-9','33696-6','33701-4','33702-2','33703-0','33704-8','33705-5','33799-8','33896-2','33902-8','34376-4','34416-8','34468-9','34714-6','34884-7','35268-2','35274-0','35280-7','35333-4','35643-6','37425-6','37991-7','37992-5','37993-3','38173-1','38174-9','38403-2','38420-6','38443-8','38516-1','39087-2','38989-0','39019-5','39021-1','39565-7','39587-1','39588-9','39611-9','39612-7','39613-5','39614-3','40607-4','40608-2','40938-3','40939-1','41426-8','40612-4','40616-5','40617-3','40655-3','40674-4','40675-1','40677-7','40678-5','40703-1','40710-6','40711-4','40712-2','40713-0','40714-8','40902-9','40903-7','40904-5','40905-2','40906-0','40907-8','40908-6','40909-4','40910-2','40911-0','40912-8','40913-6','40914-4','40915-1','40916-9','40917-7','40918-5','40919-3','40920-1','40921-9','40922-7','40923-5','40924-3','40925-0','40926-8','40942-5','41417-7','41425-0','41463-1','41475-5','41476-3','41483-9','41487-0','41499-5','41509-1','41746-9','41877-2','42199-0','42200-6','42201-4','42328-5','42329-3','42330-1','42601-5','42639-5','42724-5','42914-2','42916-7','43179-1','43182-5','43190-8','43225-2','43231-0','43236-9','43240-1','43241-9','43302-9','43602-2','44448-9','44449-7','45000-7','45001-5','45003-1','45006-4','45007-2','45092-4','43814-3','43842-4','43843-2','43849-9','43850-7','43864-8','43865-5','44099-0','44274-9','44870-4','44308-5','44357-2','44391-1','44392-9','44435-6','44436-4','44442-2','44443-0','44444-8','44447-1','44455-4','44522-1','44523-9','44524-7','44525-4','44539-5','44540-3','44708-6','44709-4','44712-8','44713-6','44736-7','44737-5','44811-8','45011-4','45039-5','45104-7','45106-2','45113-8','45132-8','45135-1','45142-7','45150-0','45151-8','45158-3','45224-3','46094-9','46112-9','46113-7','46114-5','46115-2','46116-0','46117-8','46118-6','46119-4','46120-2','46121-0','46122-8','46123-6','46124-4','46125-1','46128-5','46131-9','46248-1','46266-3','46267-1','46418-0','47316-5','47317-3','47318-1','47319-9','47320-7','48059-0','48063-2','47030-2','46969-2','46987-4','47008-8','47036-9','47037-7','47053-4','47084-9','47236-5','47237-3','47238-1','47297-7','47300-9','47301-7','47306-6','47308-2','47310-8','47311-6','47321-5','47322-3','47323-1','47324-9','47325-6','47327-2','47328-0','47329-8','47331-4','47332-2','47333-0','47335-5','47336-3','47337-1','47339-7','47340-5','47342-1','47343-9','47344-7','47346-2','47349-6','47351-2','47352-0','47353-8','47354-6','47356-1','47357-9','47361-1','47383-5','47393-4','47394-2','48501-1','48502-9','48138-2','48652-2','48653-0','48419-6','48503-7','48504-5','48505-2','48506-0','48594-6','48597-9','48997-1','48647-2','48649-8','48654-8','48655-5','48656-3','48657-1','48660-5','48822-1','49058-1','49109-2','5049-2','49329-6','49592-9','49593-7','49594-5','49595-2','49597-8','49598-6','49636-4','49767-7','49768-5','49769-3','49770-1','49771-9','49783-4','49785-9','49786-7','49798-2','49803-0','49804-8','49805-5','49806-3','49807-1','49808-9','49861-8','5044-3','5047-6','5059-1','5060-9','5062-5','5064-1','5076-5','50767-3','50768-1','50769-9','50770-7','50771-5','50772-3','5082-3','5116-9','5094-8','50979-4','51805-0','51806-8','51807-6','51808-4','51809-2','5256-3','5257-1','51407-5','51408-3','51449-7','51450-5','5150-8','51703-7','51715-1','51729-2','51742-5','51743-3','51744-1','51747-4','5174-8','51753-2','51754-0','5176-3','5177-1','5178-9','51796-1','51804-3','51810-0','51811-8','51812-6','51813-4','51814-2','51815-9','51816-7','51819-1','51820-9','51821-7','51825-8','51827-4','51838-1','51839-9','51928-0','51939-7','51940-5','51981-9','5226-6','5232-4','5233-2','5234-0','5253-0','5255-5','5275-3','5353-8','52971-9','52982-6','52983-4','5301-7','5309-0','5312-4','5314-0','5316-5','5319-9','5321-5','53419-8','53420-6','53421-4','53422-2','53423-0','53424-8','53425-5','53426-3','53427-1','53428-9','53429-7','53430-5','53431-3','5348-8','5351-2','5356-1','53594-8','5359-5','53596-3','53597-1','53598-9','5368-6','5374-4','5375-1','5380-1','53807-4','5382-7','5386-8','5388-4','5390-0','53930-4','53931-2','53935-3','54146-6','54918-8','54921-2','54924-6','55161-4','55223-2','55224-0','55844-5','56147-2','55845-2','57410-3','57411-1','57412-9','56477-3','56480-7','56485-6','56486-4','56532-5','56536-6','56537-4','56538-2','56539-0','56540-8','56541-6','56542-4','56543-2','56544-0','56545-7','56546-5','56548-1','56549-9','56620-8','56630-7','56631-5','56637-2','56718-0','5678-8','57697-5','56909-5','56910-3','56911-1','56922-8','56923-6','56940-0','56953-3','56958-2','56967-3','56984-8','56990-5','56991-3','57001-0','57009-3','57010-1', '57093-7','57320-4','57371-7','57415-2','57416-0','57436-8','57450-9','57660-3','57662-9','57670-2','57671-0','57677-7','57678-5','57679-3','57680-1','57683-5','57738-7','57748-6','58972-1','58973-9','58974-7','58975-4','58976-2','58977-0','58455-7','58462-3','58465-6','58706-3','58758-4','58762-6','58765-9','58782-4','58787-3','58798-0','58799-8','58961-4','58962-2','58963-0','58964-8','58965-5','58966-3','58967-1','58968-9','58969-7','58970-5','58971-3','58978-8','58979-6','58980-4','59003-4','59027-3','59028-1','59033-1','59034-9','59066-1','59387-1','59394-7','59400-2','59850-8','60465-2','60466-0','61430-5','62806-5','62807-3','62808-1','62809-9','6362-8','62467-6','62640-8','62641-6','62802-4','62810-7','62811-5','62853-7','62854-5','62864-4','62865-1','62866-9','62867-7','62868-5','62869-3','62870-1','62871-9','62874-3','62875-0','62876-8','62877-6','62956-8','62957-6','62966-7','62967-5','63420-4','6311-5','6312-3','6313-1','6318-0','6319-8','63210-9','63212-5','63213-3','63214-1','63215-8','63217-4','63218-2','63219-0','63222-4','63224-0','63226-5','63228-1','63229-9','63231-5','63233-1','63234-9','63235-6','63237-2','63238-0','63239-8','63240-6','63241-4','63242-2','63243-0','63244-8','63245-5','63246-3','63247-1','63248-9','63249-7','63250-5','63251-3','63252-1','63253-9','63254-7','63255-4','63256-2','63257-0','63258-8','63259-6','63260-4','63261-2','63262-0','6326-3','63263-8','63264-6','63266-1','63267-9','63269-5','6327-1','63276-0','63281-0','63282-8','63283-6','63288-5','63289-3','63290-1','63291-9','63298-4','63299-2','63300-8','63305-7','63306-5','63307-3','63308-1','63309-9','63310-7','63312-3','63314-9','63315-6','63316-4','63318-0','63319-8','63324-8','63325-5','63326-3','63327-1','63328-9','63329-7','63330-5','63332-1','63335-4','63336-2','63337-0','63338-8','63339-6','63340-4','63341-2','63342-0','63343-8','63344-6','63347-9','63348-7','63350-3','63351-1','63353-7','63354-5','63359-4','63360-2','63361-0','63362-8','63367-7','63383-4','63384-2','63387-5','6338-8','63388-3','63389-1','63391-7','63393-3','63394-1','63397-4','63398-2','63399-0','63400-6','63401-4','63402-2','63403-0','6340-4','63404-8','63405-5','63406-3','63408-9','63410-5','63411-3','6343-8','6345-3','63453-5','63459-2','63460-0','63464-2','63466-7','63467-5','63468-3','63469-1','63470-9','63471-7','63472-5','63478-2','6347-9','63479-0','6350-3','63527-6','63532-6','63533-4','63537-5','6354-5','63548-2','6359-4','6360-2','6361-0','6363-6','6364-4','6365-1','6366-9','6367-7','6425-3','6371-9','6391-7','6397-4','6398-2','6399-0','6400-6','64013-6','6401-4','6402-2','6403-0','6404-8','6405-5','6412-1','6413-9','6420-4','6426-1','6428-7','6433-7','6447-7','6448-5','6487-3','6493-1','6496-4','6499-8','6503-7','6552-4','6556-5','6558-1','6563-1','6566-4','66201-5','6620-9','6606-8','66200-7','6625-8','6627-4','6629-0','6632-4','6633-2','66482-1','66484-7','6716-5','6717-3','6779-3','67815-1','6781-9','6784-3','6787-6','6788-4','6791-8','6793-4','6799-1','68386-2','68388-8','68389-6','68548-7','6879-1','68934-9','68935-6','68936-4','68937-2','68956-2','68976-0','68977-8','68978-6','6928-6','69864-7','69865-4','69866-2','69419-0','69420-8','6964-1','6965-8','6966-6','69862-1','69863-9','69948-8','69952-0','69953-8','69954-6','69955-3','69956-1','69957-9','70051-8','70251-4','70252-2','70253-0','70254-8','70255-5','70256-3','70257-1','70569-9','70671-3','70910-5','70911-3','71425-3','71427-9','71715-7','71776-9','72260-3','72314-8','72315-5','72316-3','72317-1','72318-9','72320-5','72321-3','72322-1','72327-0','72382-5','72383-3','72724-8','72910-3','72911-1','72912-9','72913-7','72914-5','72915-2','72916-0','72922-8','73702-3','73737-9','74096-9','74099-3','74101-7','74103-3','74104-1','74106-6','74520-8','74521-6','74522-4','74805-3','74815-2','74830-1','74843-4','74844-2','74847-5','75241-0','75880-5','76399-5','76488-6','76494-4','76651-9','76772-3','78012-2','77191-5','77208-7','77209-5','77210-3','77211-1','77212-9','77213-7','77214-5','77215-2','77216-0','77217-8','77370-5','77620-3','77621-1','77622-9','77637-7','77638-5','77639-3','77640-1','77641-9','77642-7','77643-5','77644-3','77645-0','77646-8','77684-9','77743-3','77949-6','77952-0','7815-4','78433-0','79182-2','7875-8','78920-6','78987-5','79177-2','79411-5','80218-1','80219-9','8027-5','8028-3','8029-1','8033-3','80372-6','80373-4','80384-1','80385-8','80386-6','8064-8','80660-4','8066-3','81786-6','81787-4','80828-7','81310-5','81421-0','81639-7','81712-2','81714-8','81716-3','81725-4','81727-0','81728-8','81732-0','81733-8','81737-9','81738-7','81742-9','81743-7','81768-4','82299-9','82388-0','82389-8','82390-6','82391-4','82392-2','82393-0','82394-8','82395-5','82396-3','82397-1','82398-9','82399-7','82400-3','82401-1','82402-9','82403-7','82404-5','82407-8','82408-6','83113-1','83115-6','83116-4','83117-2','83118-0','82409-4','82410-2','82411-0','82413-6','82414-4','82415-1','82417-7','82418-5','82421-9','82422-7','82423-5','82424-3','82425-0','82426-8','82430-0','82431-8','82432-6','82439-1','82440-9','82441-7','82442-5','82444-1','82445-8','82447-4','82448-2','82449-0','82450-8','82451-6','82452-4','82453-2','82455-7','82466-4','82467-2','82469-8','82470-6','82990-3','82992-9','82993-7','82994-5','83066-1','82737-8','82738-6','82739-4','82740-2','82913-5','82915-0','82918-4','82919-2','82920-0','82921-8','82923-4','82924-2','82925-9','82926-7','82928-3','82931-7','82932-5','82933-3','82936-6','82995-2','82996-0','82997-8','82998-6','82999-4','83000-0','83001-8','83002-6','83003-4','83004-2','83070-3','83071-1','83072-9','83073-7','83074-5','83075-2','83076-0','83077-8','83078-6','83079-4','83080-2','83081-0','83082-8','83083-6','83084-4','83085-1','83086-9','83087-7','83088-5','83089-3','83090-1','83091-9','83092-7','83093-5','83094-3','83096-8','83097-6','83098-4','83099-2','83102-4','83103-2','83104-0','83105-7','83106-5','83107-3','83108-1','83109-9','83110-7','83111-5','83112-3','83119-8','83120-6','83121-4','83122-2','83123-0','83124-8','83125-5','83126-3','83127-1','83137-0','85086-7','85092-5','85095-8','9326-0','9327-8','9329-4','9338-5','9455-7','9456-5','9457-3','9458-1','9459-9','9460-7','9461-5','9495-3','9496-1','9521-6','9522-4','9523-2','9528-1','9529-9','9530-7','9537-2','9543-0','9611-5','9656-0','9657-8','9717-0','9718-8','9719-6','9817-8','9818-6','10653-4','10654-2','18909-2','54177-1','55663-9','10697-1','10698-9','10720-1','10721-9','10868-8','11575-8','11577-4','11578-2','14332-1','15336-1','15337-9','15338-7','16841-9','16099-4','16100-0','16386-5','16387-3','16623-1','19000-9','19001-7','172-7','192-5','173-5','174-3','175-0','176-8','177-6','17831-9','17832-7','178-4','179-2','180-0','181-8','182-6','18997-7','18998-5','18999-3','184-2','185-9','186-7','187-5','18769-0','18855-7','18863-1','18870-6','18871-4','18872-2','18881-3','18903-5','18904-3','18905-0','18906-8','18908-4','18910-0','18914-2','18915-9','18917-5','18918-3','18921-7','18922-5','18924-1','18925-8','18926-6','18927-4','18930-8','18934-0','18935-7','18936-5','18937-3','18938-1','18939-9','18940-7','18941-5','18942-3','18944-9','18946-4','18948-0','18949-8','18952-2','18953-0','18954-8','18955-5','18956-3','18957-1','18958-9','18959-7','18960-5','18962-1','18963-9','18968-8','18973-8','18974-6','18975-3','18976-1','18977-9','18979-5','18980-3','18981-1','18982-9','18983-7','18984-5','18985-2','18986-0','18987-8','18989-4','18990-2','18992-8','18993-6','19149-4','19156-9','193-3','194-1','195-8','196-6','197-4','198-2','212-1','203-0','20376-0','20377-8','20379-4','20381-0','20382-8','20383-6','20384-4','20385-1','20386-9','20387-7','20388-5','20389-3','20390-1','20391-9','20396-8','20397-6','20461-0','20462-8','20629-2','21070-8','21316-5','21367-8','213-9','214-7','215-4','216-2','217-0','218-8','23609-1','23610-9','23611-7','23614-1','224-6','225-3','226-1','228-7','229-5','230-3','23-2','23607-5','23608-3','23615-8','23616-6','23617-4','23620-8','23621-6','23623-2','23625-7','23626-5','23627-3','23628-1','23629-9','23630-7','23631-5','23632-3','23638-0','23639-8','23640-6','23641-4','23642-2','23643-0','23658-8','23659-6','23712-3','23740-4','23947-5','23948-3','23817-0','23818-8','23949-1','24-0','240-2','241-0','242-8','25213-0','25214-8','25215-5','25216-3','25217-1','25218-9','25219-7','25722-0','243-6','249-3','248-5','250-1','25180-1','25181-9','25182-7','25183-5','25184-3','25185-0','25186-8','25187-6','25188-4','25189-2','251-9','25194-2','25195-9','25196-7','25198-3','25199-1','25200-7','25201-5','25202-3','25203-1','25204-9','25205-6','25206-4','25207-2','25208-0','25209-8','25210-6','25211-4','25212-2','25222-1','25223-9','25225-4','25226-2','25228-8','25229-6','25230-4','25231-2','252-7','263-4','253-5','25411-0','254-3','25452-4','255-0','25595-0','25596-8','25597-6','25607-3','25608-1','25637-0','25653-7','256-8','25-7','25702-2','25723-8','257-6','258-4','259-2','260-0','261-8','262-6','264-2','26-5','270-9','271-7','272-5','273-3','286-5','287-3','288-1','289-9','290-7','291-5','292-3','29254-0','29255-7','29258-1','293-1','29315-9','294-9','295-6','29579-0','296-4','297-2','298-0','299-8','300-4','301-2','302-0','30268-7','30269-5','30270-3','30271-1','30272-9','30282-8','30283-6','30284-4','30285-1','30286-9','30298-4','30300-8','30301-6','30302-4','303-8','304-6','305-3','306-1','307-9','308-7','310-3','31036-7','31037-5','31038-3','31039-1','31040-9','31041-7','31042-5','31043-3','311-1','312-9','314-5','315-2','316-0','318-6','319-4','320-2','32372-5','32373-3','32376-6','32379-0','32381-6','32382-4','32383-2','32384-0','32597-7','32603-3','32633-0','326-9','327-7','328-5','329-3','33332-8','33334-4','33284-1','334-3','335-0','341-8','336-8','338-4','339-2','340-0','354-1','350-9','351-7','352-5','355-8','356-6','35754-1','35755-8','35756-6','35785-5','35786-3','35787-1','35788-9','35789-7','35790-5','35791-3','35792-1','35796-2','35797-0','35798-8','35803-6','35804-4','35805-1','35806-9','35807-7','35808-5','35809-3','35810-1','35811-9','35812-7', '35813-5','35814-3','35815-0','35816-8','35818-4','358-2','35820-0','35821-8','35822-6','35823-4','35824-2','35825-9','35826-7','35827-5','35828-3','35829-1','35830-9','35831-7','35833-3','35834-1','35835-8','35836-6','35837-4','35838-2','35839-0','359-0','364-0','35840-8','35841-6','35842-4','35846-5','35847-3','35848-1','35849-9','35850-7','35851-5','35852-3','35853-1','35854-9','35855-6','35856-4','35857-2','35858-0','35859-8','35860-6','35861-4','35862-2','35863-0','360-8','362-4','363-2','372-3','366-5','367-3','368-1','370-7','371-5','373-1','374-9','379-8','375-6','376-4','377-2','378-0','380-6','381-4','389-7','386-3','387-1','388-9','390-5','403-6','404-4','405-1','41199-1','41200-7','41402-9','41408-6','41409-4','41410-2','41494-6','41500-0','41502-6','41504-2','41658-6','41659-4','41660-2','41685-9','41686-7','41687-5','41688-3','41689-1','41690-9','41691-7','41692-5','41693-3','41694-1','41695-8','41696-6','41697-4','41698-2','41699-0','41700-6','41701-4','41705-5','41706-3','41707-1','41708-9','41709-7','41710-5','41711-3','41712-1','41713-9','41714-7','41715-4','41716-2','41717-0','41718-8','41723-8','41724-6','41725-3','41726-1','41733-7','41734-5','41735-2','41736-0','41737-8','41738-6','41739-4','424-2','427-5','428-3','42317-8','423-4','425-9','42643-7','42644-5','42645-2','42646-0','42647-8','42648-6','42649-4','42650-2','42651-0','42652-8','42653-6','42654-4','42655-1','42656-9','42657-7','42658-5','42659-3','426-7','42720-3','429-1','42935-7','435-8','430-9','431-7','432-5','433-3','434-1','436-6','437-4','438-2','439-0','43986-9','43988-5','43989-3','440-8','441-6','442-4','451-5','45215-1','447-3','448-1','449-9','450-7','45187-2','452-3','453-1','461-4','455-6','454-9','456-4','457-2','458-0','459-8','460-6','462-2','463-0','464-8','471-3','465-5','466-3','467-1','46719-1','468-9','469-7','470-5','472-1','473-9','474-7','475-4','476-2','477-0','483-8','478-8','48170-5','48171-3','48172-1','48173-9','48177-0','485-3','484-6','48685-2','487-9','488-7','489-5','490-3','49080-5','495-2','496-0','49620-8','49669-5','497-8','525-6','511-6','512-4','51-3','513-2','515-7','51719-3','52-1','516-5','51694-8','51698-9','517-3','519-9','520-7','521-5','522-3','523-1','524-9','526-4','527-2','528-0','529-8','530-6','531-4','53716-7','53818-1','53822-3','53824-9','53-9','54169-8','54173-0','54178-9','54179-7','54180-5','54181-3','54182-1','54183-9','54184-7','54186-2','54187-0','54188-8','54189-6','54200-1','54201-9','54202-7','54204-3','55676-1','55677-9','55678-7','55679-5','55680-3','54-7','54928-7','55154-9','55156-4','55194-5','55196-0','55292-7','55293-5','55294-3','55-4','55617-5','55618-3','55619-1','55621-7','55622-5','55623-3','55624-1','55625-8','55626-6','55627-4','55655-5','55656-3','55657-1','55658-9','55659-7' ))

-- Step 5 - Delta Data
CREATE TABLE SANDBOX.Shionogi_GN_Claims_Updated_v4_Final AS
SELECT * FROM SANDBOX.Shionogi_GN_Claims_Updated_v4 WHERE CLAIM_NUMBER NOT IN ( SELECT DISTINCT CLAIM_NUMBER FROM sandbox.Shionogi_GN_Claims_Updated_V3 );

CREATE TABLE SANDBOX.Shionogi_GN_Services_Updated_v4_Final AS
SELECT * FROM SANDBOX.Shionogi_GN_Services_Updated_v4 WHERE CLAIM_NUMBER NOT IN ( SELECT DISTINCT CLAIM_NUMBER FROM sandbox.Shionogi_GN_Services_Updated_V3 );

CREATE TABLE SANDBOX.Shionogi_GN_Pharmacy_EMD_Updated_v4_Final AS
SELECT * FROM SANDBOX.Shionogi_GN_Pharmacy_EMD_Updated_v4 WHERE CLAIM_NUMBER NOT IN ( SELECT DISTINCT CLAIM_NUMBER FROM sandbox.Shionogi_GN_Pharmacy_EMD_Updated_V3 );

-- Step 6 - Extracting the data s3 to share folder

-- Path: "\\dresources.com\data\PUBLIC_SHARE\drg-snowflake-external-stage\".

-- Port No - 21, Jaga - 990

-- Header
COPY INTO '@RWD_DB.PUBLIC.DRG_END_USER_STAGE/send-to-share/Vinod/Shionogi_GN_Claims_Updated_v4_Final' 
FROM RWD_DB.sandbox.Shionogi_GN_Claims_Updated_v4_Final  FILE_FORMAT=(FORMAT_NAME='RWD_DB.PUBLIC.RWD_CSV_FORMAT' FIELD_DELIMITER=',' COMPRESSION = GZIP)
HEADER = TRUE
SINGLE = TRUE
MAX_FILE_SIZE = 5000000000
OVERWRITE = TRUE;

-- Service
COPY INTO '@RWD_DB.PUBLIC.DRG_END_USER_STAGE/send-to-share/Vinod/Shionogi_GN_Services_Updated_v4_Final' 
FROM RWD_DB.sandbox.Shionogi_GN_Services_Updated_v4_Final  FILE_FORMAT=(FORMAT_NAME='RWD_DB.PUBLIC.RWD_CSV_FORMAT' FIELD_DELIMITER=',' COMPRESSION = GZIP)
HEADER = TRUE
SINGLE = TRUE
MAX_FILE_SIZE = 5000000000
OVERWRITE = TRUE;

-- Pharmacy
COPY INTO '@RWD_DB.PUBLIC.DRG_END_USER_STAGE/send-to-share/Vinod/Shionogi_GN_Pharmacy_EMD_Updated_v4_Final' 
FROM RWD_DB.sandbox.Shionogi_GN_Pharmacy_EMD_Updated_v4_Final  FILE_FORMAT=(FORMAT_NAME='RWD_DB.PUBLIC.RWD_CSV_FORMAT' FIELD_DELIMITER=',' COMPRESSION = GZIP)
HEADER = TRUE
SINGLE = TRUE
MAX_FILE_SIZE = 5000000000
OVERWRITE = TRUE;
